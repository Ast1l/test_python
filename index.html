<script>
// --- –ù–ê–°–¢–†–û–ô–ö–ò TELEGRAM ---
const TELEGRAM_BOT_TOKEN = '8442506195:AAFi-gB__XLLN4mHdS9tk8BAD8sDc_oGuIg'; 
const TELEGRAM_CHAT_ID = 'andreystilbot';
// --------------------------

let username = '';
let currentQuestion = 0;
let score = 0;

// –í–∞—à –º–∞—Å—Å–∏–≤ –≤–æ–ø—Ä–æ—Å–æ–≤ (—è –æ—Å—Ç–∞–≤–∏–ª –ª–æ–≥–∏–∫—É –ø—Ä–µ–∂–Ω–µ–π)
let questions = [
    { question: "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–∞—Ç—á?", variants: ["–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –∏–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏","–ù–æ–≤—ã–π –≤–∏—Ä—É—Å","–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª","–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"], answer: "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –∏–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏" },
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã ...
];

function startTest() {
    username = document.getElementById('username').value;
    if (username.trim() === "") {
        alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–º—è!");
        return;
    }
    document.getElementById('startScreen').style.display = 'none';
    document.getElementById('quizScreen').style.display = 'block';
    showQuestion();
}

function showQuestion() {
    if (currentQuestion >= questions.length) {
        showResults();
        return;
    }
    let q = questions[currentQuestion];
    document.getElementById('questionText').innerText = q.question;
    let variantsDiv = document.getElementById('variants');
    variantsDiv.innerHTML = '';
    q.variants.forEach(variant => {
        let btn = document.createElement('button');
        btn.className = 'variant';
        btn.innerText = variant;
        btn.onclick = () => checkAnswer(variant);
        variantsDiv.appendChild(btn);
    });
}

function checkAnswer(selected) {
    if (selected === questions[currentQuestion].answer) {
        score++;
    }
    currentQuestion++;
    showQuestion();
}

function showResults() {
    document.getElementById('quizScreen').style.display = 'none';
    document.getElementById('resultScreen').style.display = 'block';
    document.getElementById('userDisplay').innerText = username;
    document.getElementById('scoreText').innerText = `–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${score} –∏–∑ ${questions.length}`;

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram
    sendToTelegram();
}

function sendToTelegram() {
    const message = `
üîî *–ù–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞!*
üë§ –ò–º—è: ${username}
üìä –ë–∞–ª–ª—ã: ${score} –∏–∑ ${questions.length}
‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç: ${Math.round((score / questions.length) * 100)}%
    `;

    const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;

    fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            chat_id: TELEGRAM_CHAT_ID,
            text: message,
            parse_mode: 'Markdown'
        })
    })
    .then(response => {
        if (!response.ok) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ Telegram');
        } else {
            console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram');
        }
    })
    .catch(error => console.error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏:', error));
}
</script>